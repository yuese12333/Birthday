<div align="center">

# 生日互动回忆小游戏

一次把「过去 → 当下 → 未来」浓缩成互动旅程的 H5 礼物。

| 场景编号 | 标题关键词 | 玩法核心 | 状态 |
|----------|------------|----------|------|
| 0 | 注册仪式 | 纪念日密码 + 线索渐进 | 已实现 ✅ |
| 1 | 高中安抚 | 情绪值 + 组合加成 + 泡泡反馈 | 已实现 ✅ |
| 2 | 高考小游戏 | 四科题库 + 提示三段式 + 宠溺得分 | 已实现 ✅ |
| 3 | 大学时间线 | 拖拽排序 | 基础实现 ✅ |
| 4 | 表白分支 | 对话逐行 + 选项分支 + 彩蛋 | 基础实现 ✅ |
| 5 | 约会菜单 | 选菜加分 / 默契值 | 基础实现 ✅ |
| 6 | 织围巾 | 点亮网格 + 进度条 | 基础实现 ✅ |
| 7 | 未来愿望 | 许愿生成星星 + 终章祝福 | 基础实现 ✅ |

</div>

> 全部纯原生 HTML / CSS / JS，无构建依赖，直接双击 `index.html` 即可体验。

---
## 🔧 快速开始
1. 下载或克隆项目。
2. 用浏览器打开根目录下 `index.html`。
3. 若放到 GitHub Pages / Vercel / Netlify：直接部署静态资源，无需服务器。

可用 URL 参数：
`?forceRegister=1` 强制再次进入注册仪式（或使用快捷键 Ctrl+Alt+R）。

---
## 📁 目录结构
```
assets/
  images/            # 图片（自备真实照片可更有代入感）
  audio/             # 计划中的 BGM / SFX
css/                 # 全局 + 场景样式（集中在 styles.css）
js/
  core/              # BaseScene / SceneManager / EventBus 等基类
  scenes/            # 场景 0~7 源文件
  main.js            # 入口（注册场景 & 全局防抖 & 快捷键）
data/
  questions.json     # 外部题库（存在即覆盖内置）
index.html
README.md
```

---
## 🧭 场景总览（按体验顺序）

### 0. 注册仪式（Scene0Register）
**当前实现**
- 输入任意“用户名” + 纪念日密码（默认 `20241007`）。
- 密码错误计数触发 3 / 5 / 7 次线索（逐条淡入：年 → 月 → 日 + 完整组合）。
- 支持“我忘了”按钮单步解锁下一条线索；终极线索出现后按钮自动禁用。
- 通过写入 `localStorage.hasRegistered=1`，下次自动跳过。
- 支持强制重体验（URL 参数 / 快捷键 / 悬浮按钮）。
- 全局点击防抖：提交、忘记按钮均带 `data-debounce`。 

**未来预期**
- Serious 模式：关闭忘记按钮或延迟可用。
- 成就：不看任何线索一次通过授予徽章。
- 主题可配置：不同纪念日切换背景 / 标题文案。

### 1. 高中安抚（Scene1Intro）
**当前实现**
- 目标情绪值：100。
- 不同类别（comfort / encourage / companion）形成“多样陪伴”组合：2 类+2、3 类+4 加成。
- 情绪泡泡漂浮反馈（正向 / 负向 / 组合 / 救援 / 彩蛋）。
- 连续负向：第 3 次触发救援反弹 +8 正向；负面逐步柔化。
- 标题点击：7 次提示，10 次一次性 +5 加成彩蛋。
- 50% 进度出现“我现在就抱紧你”按钮（快速补满 → 跳转场景2）。
- 冷启动 2 秒禁用所有按钮（视觉提示“缓冲”）。
- 防抖：快速抱紧按钮 `data-debounce` 防止重复触发。

**未来预期**
- 统计面板：显示最高组合数 / 负向救援触发次数。
- 难度可选：提高目标值或减少加成。
- BGM 节奏联动：情绪越高音乐层次增加。

### 2. 高考小游戏（Scene2Exam）
**当前实现**
- 四科题型分类：诗填空 / 数学小算式 / 英文配对 / 科学选择题。
- 外部题库 JSON 自动覆盖内置（结构见下）。
- 难度权重：easy=1, medium=2, hard=3；得分 = 2 * 权重（统一宠溺满分）。
- 跳过（撒娇）= 满分；答错 = 展示正确答案 + 满分；提示三次：第 3 次直接给答案 + 满分。
- 每题鼓励语字段：`encourageCorrect` / `encourageWrong`。
- 计时器：5 分钟循环倒计时，结束后给一段“没关系被我抱走”文案并刷新新一轮（若尚未做完）。
- 彩蛋（互斥展示，优先级：全跳过 > 全部错误宠溺 > 半数跳过）。
- 结果面板整合得分与彩蛋标签。

**未来预期**
- Serious 模式：跳过不给分 / 错误减分 / 第三次提示不送答案。
- 成就：全对 / 全跳过 / 不用提示 / 首次全错（被宠）。
- 答题统计图标（雷达 / 饼图）。
- 支持自适应题型插件机制（扩展多选 / 连线 / 音频题）。

### 3. 大学时间线（Scene3Timeline）
**当前实现**
- 拖拽排序若干事件，校验正确顺序反馈结果。
- 使用原生拖放 API，正确后可进入下一场景。

**未来预期**
- 模糊匹配：允许局部错位给“几乎完美”提示。
- 事件补充图 / 照片悬浮预览。
- 时间轴动画（排列成功后缓动排版）。

### 4. 表白分支（Scene4Confession）
**当前实现**
- 对话逐行延迟展示；选择互动按钮触发不同回应。
- 暂存选择路径（用于后续彩蛋扩展）。
- 权限内小彩蛋按钮（隐藏按钮或特定点击次数触发）。

**未来预期**
- 多轮记忆：后续场景读入你在此场景的“回答风格”。
- 分支结局徽章：温柔派 / 贫嘴派 / 火花派。
- 打字机动画 & 心跳特效。

### 5. 第一次约会（Scene5Date）
**当前实现**
- 菜单多选，基于每项得分累计“默契值”。
- 场景内简单舞台 / 灯光氛围背景（CSS 动画）。

**未来预期**
- 偏好记忆：高分菜品被选后在终章出现“专属标签”。
- 隐形冲突：选择特定组合触发隐藏对话（彩蛋）。
- 计时或轮次（限定 3 选 1，多轮累计）。

### 6. 织围巾（Scene6Scarf）
**当前实现**
- 网格点击点亮（渐进填色），显示当前完成进度。
- 进度达标出现继续按钮。

**未来预期**
- 像素图模板：预设心形 / 首字母图案自动判定是否“织对”。
- 长按刷子模式 / 拖拽涂抹。
- 颜色渐变随着进度加温（视觉情绪化）。

### 7. 未来愿望星空（Scene7Future）
**当前实现**
- 输入愿望生成星点（动画闪烁）。
- 达到指定愿望数量出现终章祝福卡片（现实祝福，不循环重开）。
- 支持自定义愿望数量阈值。

**未来预期**
- 星星分类（旅行 / 成长 / 情感）→ 不同颜色。
- 点击星星回显愿望全文 / 编辑 / 标记完成。
- 读取前面场景统计（题目跳过次数、组合最高值）嵌入终章文案个性化。

---
## 📌 外部题库结构（场景2）
```jsonc
{
  "chinesePoemFill": [
    { "question": "山有木兮木有枝，_____", "answer": "心悦君兮君不知", "encourageCorrect": "诗意满分！", "encourageWrong": "再想想那句古风情话~" }
  ],
  "mathPuzzles": [
    { "question": "(5 + 1) × 2 - 3 = ?", "answer": "9", "encourageCorrect": "脑力很清醒！", "encourageWrong": "括号顺序再过一遍~" }
  ],
  "englishMatch": [
    { "word": "forever", "match": "永远", "encourageCorrect": "Forever = 永远爱你", "encourageWrong": "我们常说的那个‘永**’" }
  ],
  "scienceQuiz": [
    { "question": "彩虹形成主要和什么光学现象有关？", "options": ["折射","衍射","干涉"], "answer": 0, "encourageCorrect": "彩虹为你弯下腰~", "encourageWrong": "想想光进水再出来会怎样~" }
  ]
}
```
字段说明：
- ch\*：不同题型数组；存在即覆盖该类默认题。
- `encourageCorrect` / `encourageWrong`：个性化鼓励。
- 选择题 `answer` 为索引；填空 / 配对类型 `answer` 为字符串。

---
## ❤️ 宠溺/得分与提示规则速览
- 正确 / 跳过 / 错误（被宠）/ 第三次提示 → 统一给满分（2 * 难度权重）。
- 提示机制：前两次展示文本，第 3 次直接送答案 + 满分。
- 彩蛋优先级：全跳过 > 全错误宠溺 > 半数跳过。
- 未来 Serious 模式将收紧：跳过不给分 / 错误减分 / 第三次提示只给 0 分答案提示。

---
## 🛡️ 全局机制
| 机制 | 描述 |
|------|------|
| 场景管理 | `SceneManager` 控制生命周期 enter/exit，防并发切换锁。|
| 事件总线 | `EventBus`（当前轻量，预留解耦扩展）。|
| 全局防抖 | 任意元素加 `data-debounce` 即可，捕获阶段阻断重复点击。|
| 本地持久 | `localStorage.hasRegistered` 标记注册通过一次即可跳过。|
| 外部题库 | 自动 fetch `data/questions.json` 覆盖内置。|
| 彩蛋系统 | 目前分散（场景1 标题点击 / 场景2 结果统计），后续计划集中注册。|

---
## 🧩 自定义常用入口
- 修改安抚按钮：`scene1_intro.js` 里 `<button data-mood ...>` 节点列表。
- 修改题库：放置 / 编辑 `data/questions.json`。
- 增减时间线事件：`scene3_timeline.js` 的 `this.items`。
- 增加表白台词：`scene4_confession.js` 中对话数组。
- 修改菜单：`scene5_date.js` 的 `this.menu`。
- 围巾尺寸：`scene6_scarf.js` 中网格行列参数。
- 愿望阈值：`scene7_future.js` 中 `this.required`。

---
## 🪄 未来路线（Roadmap）
| 类别 | 计划 | 状态 |
|------|------|------|
| 模式 | Serious 模式（收紧容错） | 待设计 |
| 成就 | 全对 / 无提示 / 零跳过 / 彩蛋收集 | 待实现 |
| 统计 | 组合最高值 / 错误来源分析 | 待实现 |
| 音频 | BGM + 微动效音效 | 待添加 |
| 彩蛋 | 统一 registry + 条件 DSL | 规划中 |
| 个性化 | 终章引用前面统计（例如你“××题都跳过”） | 规划中 |
| UI | 主题切换（粉 / 暖白 / 星空） | 规划中 |
| 国际化 | 全文案 JSON 化 + 多语言 | 规划中 |

---
## 📝 素材准备清单
- 高中安抚真实语气 5~8 句
- 高考题库（可按你们的梗定制）
- 大学事件 4~6 条（带年份 / 月份）
- 表白真情台词分支（甜 / 搞怪 / 深情）
- 约会菜单（菜品 + 共同回忆标签）
- 围巾是否要心形、首字母或日期彩蛋
- 未来愿望 6~10 条（旅行 / 成长 / 生活 / 仪式）
- 私人彩蛋关键词（昵称 / 暗号）

---
## 🚀 部署
- GitHub Pages：Settings → Pages → 选 main 分支 root。
- Vercel / Netlify：直接导入仓库 → 部署。
- 本地打包：压缩整个目录发送即可离线打开。

---
## 🔐 隐私 & 安全
若包含真实照片 / 聊天记录，避免公开仓库；或改用临时受限分享链接。

---
## License
私人情感礼物项目（非商业）。如需二次传播请先移除私人素材。

> 祝：故事继续被认真书写，愿望都按计划一个个兑现。❤️
